<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Budget Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <div id="root"></div>

<script>
    const { useState, useEffect, useRef } = React;
    
    // Create icon components
    const PlusCircle = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('circle', { cx: '12', cy: '12', r: '10' }),
        React.createElement('path', { d: 'M12 8v8m-4-4h8' })
    );
    
    const Trash2 = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('polyline', { points: '3,6 5,6 21,6' }),
        React.createElement('path', { d: 'M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2 2h4a2 2 0 0 1 2 2v2' }),
        React.createElement('line', { x1: '10', y1: '11', x2: '10', y2: '17' }),
        React.createElement('line', { x1: '14', y1: '11', x2: '14', y2: '17' })
    );
    
    const Edit3 = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('path', { d: 'M12 20h9' }),
        React.createElement('path', { d: 'M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z' })
    );
    
    const MapPin = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('path', { d: 'M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z' }),
        React.createElement('circle', { cx: '12', cy: '10', r: '3' })
    );
    
    const DollarSign = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('line', { x1: '12', y1: '1', x2: '12', y2: '23' }),
        React.createElement('path', { d: 'M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6' })
    );
    
    const Euro = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('path', { d: 'M20 12c0-6.627-5.373-12-12-12S-4 5.373-4 12s5.373 12 12 12c1.657 0 3.23-.336 4.665-.942' }),
        React.createElement('path', { d: 'M7 12h5m-5-3h5' })
    );

    const Settings = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('circle', { cx: '12', cy: '12', r: '3' }),
        React.createElement('path', { d: 'M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z' })
    );

    const Save = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('path', { d: 'M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z' }),
        React.createElement('polyline', { points: '17,21 17,13 7,13 7,21' }),
        React.createElement('polyline', { points: '7,3 7,8 15,8' })
    );

    const X = (props) => React.createElement('svg', {
        ...props,
        fill: 'none',
        stroke: 'currentColor',
        viewBox: '0 0 24 24',
        xmlns: 'http://www.w3.org/2000/svg'
    }, 
        React.createElement('line', { x1: '18', y1: '6', x2: '6', y2: '18' }),
        React.createElement('line', { x1: '6', y1: '6', x2: '18', y2: '18' })
    );

    const TravelBudgetTracker = () => {
        // Load data from localStorage on component mount
        const [expenses, setExpenses] = useState(() => {
            try {
                const savedExpenses = localStorage.getItem('travelBudgetExpenses');
                return savedExpenses ? JSON.parse(savedExpenses) : [];
            } catch (error) {
                console.error('Error loading expenses from localStorage:', error);
                return [];
            }
        });

        const [budgets, setBudgets] = useState(() => {
            try {
                const savedBudgets = localStorage.getItem('travelBudgetBudgets');
                return savedBudgets ? JSON.parse(savedBudgets) : {
                    Dan: {
                        Food: 500,
                        Transportation: 300,
                        Shopping: 400,
                        Accommodations: 800,
                        Activities: 250,
                        Miscellaneous: 150
                    },
                    Tien: {
                        Food: 500,
                        Transportation: 300,
                        Shopping: 400,
                        Accommodations: 800,
                        Activities: 250,
                        Miscellaneous: 150
                    }
                };
            } catch (error) {
                console.error('Error loading budgets from localStorage:', error);
                return {
                    Dan: {
                        Food: 500,
                        Transportation: 300,
                        Shopping: 400,
                        Accommodations: 800,
                        Activities: 250,
                        Miscellaneous: 150
                    },
                    Tien: {
                        Food: 500,
                        Transportation: 300,
                        Shopping: 400,
                        Accommodations: 800,
                        Activities: 250,
                        Miscellaneous: 150
                    }
                };
            }
        });

        const [exchangeRate, setExchangeRate] = useState(() => {
            try {
                const savedRate = localStorage.getItem('travelBudgetExchangeRate');
                return savedRate ? parseFloat(savedRate) : 1.17;
            } catch (error) {
                console.error('Error loading exchange rate from localStorage:', error);
                return 1.17;
            }
        });
        
        const [showAddForm, setShowAddForm] = useState(false);
        const [showBudgetEdit, setShowBudgetEdit] = useState(false);
        const [editingId, setEditingId] = useState(null);
        const [activePerson, setActivePerson] = useState('Dan');
        const [activeTab, setActiveTab] = useState('categories');
        const [budgetEditPerson, setBudgetEditPerson] = useState('Dan');
        const [tempBudgets, setTempBudgets] = useState({});
        const fileInputRef = useRef(null);
        
        const [formData, setFormData] = useState({
            memo: '',
            category: 'Food',
            amount: '',
            date: new Date().toISOString().slice(0, 16),
            payer: 'Dan'
        });

        const categories = ['Food', 'Transportation', 'Shopping', 'Accommodations', 'Activities', 'Miscellaneous'];

        // Save data to localStorage whenever state changes
        useEffect(() => {
            try {
                localStorage.setItem('travelBudgetExpenses', JSON.stringify(expenses));
            } catch (error) {
                console.error('Error saving expenses to localStorage:', error);
            }
        }, [expenses]);

        useEffect(() => {
            try {
                localStorage.setItem('travelBudgetBudgets', JSON.stringify(budgets));
            } catch (error) {
                console.error('Error saving budgets to localStorage:', error);
            }
        }, [budgets]);

        useEffect(() => {
            try {
                localStorage.setItem('travelBudgetExchangeRate', exchangeRate.toString());
            } catch (error) {
                console.error('Error saving exchange rate to localStorage:', error);
            }
        }, [exchangeRate]);

        useEffect(() => {
            setExchangeRate(1.17);
        }, []);

        const resetForm = () => {
            setFormData({
                memo: '',
                category: 'Food',
                amount: '',
                date: new Date().toISOString().slice(0, 16),
                payer: 'Dan'
            });
            setShowAddForm(false);
            setEditingId(null);
        };

        const handleSubmit = (e) => {
            e.preventDefault();
            if (!formData.memo || !formData.amount) return;

            const amount = parseFloat(formData.amount);
            const expense = {
                id: editingId || Date.now(),
                memo: formData.memo,
                category: formData.category,
                amount: amount,
                date: formData.date,
                payer: formData.payer,
                usdAmount: amount * exchangeRate,
                danAmount: formData.payer === 'Split' ? amount / 2 : (formData.payer === 'Dan' ? amount : 0),
                tienAmount: formData.payer === 'Split' ? amount / 2 : (formData.payer === 'Tien' ? amount : 0)
            };

            if (editingId) {
                setExpenses(expenses.map(exp => exp.id === editingId ? expense : exp));
            } else {
                setExpenses([...expenses, expense]);
            }
            
            resetForm();
        };

        const deleteExpense = (id) => {
            setExpenses(expenses.filter(exp => exp.id !== id));
        };

        const editExpense = (expense) => {
            setFormData({
                memo: expense.memo,
                category: expense.category,
                amount: expense.amount.toString(),
                date: expense.date,
                payer: expense.payer
            });
            setEditingId(expense.id);
            setShowAddForm(true);
        };

        const getCategorySpending = (category, person) => {
            return expenses
                .filter(exp => exp.category === category)
                .reduce((sum, exp) => {
                    if (person === 'Dan') return sum + exp.danAmount;
                    if (person === 'Tien') return sum + exp.tienAmount;
                    return sum + exp.amount;
                }, 0);
        };

        const getTotalSpending = (person) => {
            return expenses.reduce((sum, exp) => {
                if (person === 'Dan') return sum + exp.danAmount;
                if (person === 'Tien') return sum + exp.tienAmount;
                return sum + exp.amount;
            }, 0);
        };

        const getTotalBudget = (person) => {
            if (person === 'Dan' || person === 'Tien') {
                return Object.values(budgets[person]).reduce((a, b) => a + b, 0);
            }
            return Object.values(budgets.Dan).reduce((a, b) => a + b, 0) + Object.values(budgets.Tien).reduce((a, b) => a + b, 0);
        };

        const openBudgetEdit = () => {
            setTempBudgets(JSON.parse(JSON.stringify(budgets)));
            setShowBudgetEdit(true);
        };

        const saveBudgetChanges = () => {
            setBudgets(tempBudgets);
            setShowBudgetEdit(false);
            setTempBudgets({});
        };

        const cancelBudgetEdit = () => {
            setShowBudgetEdit(false);
            setTempBudgets({});
        };

        const updateTempBudget = (person, category, value) => {
            const numValue = parseFloat(value) || 0;
            setTempBudgets(prev => ({
                ...prev,
                [person]: {
                    ...prev[person],
                    [category]: numValue
                }
            }));
        };

        const clearAllData = () => {
            if (window.confirm('Are you sure you want to clear all data? This cannot be undone.')) {
                try {
                    localStorage.removeItem('travelBudgetExpenses');
                    localStorage.removeItem('travelBudgetBudgets');
                    localStorage.removeItem('travelBudgetExchangeRate');
                    setExpenses([]);
                    setBudgets({
                        Dan: {
                            Food: 500,
                            Transportation: 300,
                            Shopping: 400,
                            Accommodations: 800,
                            Activities: 250,
                            Miscellaneous: 150
                        },
                        Tien: {
                            Food: 500,
                            Transportation: 300,
                            Shopping: 400,
                            Accommodations: 800,
                            Activities: 250,
                            Miscellaneous: 150
                        }
                    });
                    setExchangeRate(1.17);
                } catch (error) {
                    console.error('Error clearing data:', error);
                }
            }
        };

        const exportToCSV = () => {
            try {
                const csvHeader = 'Date,Description,Category,Amount (EUR),Amount (USD),Payer,Dan Amount (EUR),Tien Amount (EUR)\n';
                const csvRows = expenses.map(expense => {
                    const date = new Date(expense.date).toLocaleString();
                    return `"${date}","${expense.memo.replace(/"/g, '""')}","${expense.category}",${expense.amount},${expense.usdAmount.toFixed(2)},"${expense.payer}",${expense.danAmount.toFixed(2)},${expense.tienAmount.toFixed(2)}`;
                }).join('\n');
                
                const csvContent = csvHeader + csvRows;
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', `travel-budget-${new Date().toISOString().split('T')[0]}.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            } catch (error) {
                console.error('Error exporting CSV:', error);
                alert('Error exporting data. Please try again.');
            }
        };

        const getProgressColor = (spent, budget) => {
            const percentage = (spent / budget) * 100;
            if (percentage >= 90) return 'bg-red-500';
            if (percentage >= 75) return 'bg-yellow-500';
            return 'bg-green-500';
        };

        return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4" },
            React.createElement('div', { className: "max-w-4xl mx-auto" },
                // Header
                React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                    React.createElement('div', { className: "flex items-center justify-between" },
                        React.createElement('div', { className: "flex items-center space-x-3" },
                            React.createElement(MapPin, { className: "h-8 w-8 text-indigo-600" }),
                            React.createElement('div', null,
                                React.createElement('h1', { className: "text-3xl font-bold text-gray-900" }, "Travel Budget Tracker"),
                                React.createElement('p', { className: "text-gray-600" }, "Portugal & France Adventure - Dan & Tien")
                            )
                        ),
                        React.createElement('div', { className: "text-right" },
                            React.createElement('div', { className: "text-sm text-gray-500" }, "Exchange Rate"),
                            React.createElement('div', { className: "text-lg font-semibold" }, `1 EUR = $${exchangeRate.toFixed(2)} USD`)
                        )
                    ),
                    
                    // Person Toggle
                    React.createElement('div', { className: "mt-4 flex justify-center" },
                        React.createElement('div', { className: "bg-gray-100 rounded-lg p-1 flex" },
                            ['Dan', 'Tien', 'Combined'].map(person =>
                                React.createElement('button', {
                                    key: person,
                                    onClick: () => setActivePerson(person),
                                    className: `px-4 py-2 rounded-md transition-colors ${
                                        activePerson === person
                                            ? 'bg-indigo-600 text-white'
                                            : 'text-gray-600 hover:text-gray-900'
                                    }`
                                }, person)
                            )
                        )
                    )
                ),

                // Action Buttons
                React.createElement('div', { className: "mb-6 flex flex-wrap gap-3" },
                    React.createElement('button', {
                        onClick: () => setShowAddForm(true),
                        className: "bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg flex items-center space-x-2 transition-colors"
                    },
                        React.createElement(PlusCircle, { className: "h-5 w-5" }),
                        React.createElement('span', null, "Add Expense")
                    ),
                    React.createElement('button', {
                        onClick: openBudgetEdit,
                        className: "bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg flex items-center space-x-2 transition-colors"
                    },
                        React.createElement(Settings, { className: "h-5 w-5" }),
                        React.createElement('span', null, "Edit Budgets")
                    ),
                    // --- ADD THIS EXPORT BUTTON ---
                    React.createElement('button', {
                        onClick: exportToCSV,
                        className: "bg-yellow-500 hover:bg-yellow-600 text-white px-6 py-3 rounded-lg flex items-center space-x-2 transition-colors"
                    },
                        React.createElement('svg', { className: "h-5 w-5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", xmlns: "http://www.w3.org/2000/svg" },
                            React.createElement('path', { d: "M12 5v14m7-7H5" })
                        ),
                        React.createElement('span', null, "Export CSV")
                    )
                    // --- END EXPORT BUTTON ---
                ),

                // Budget Edit Modal
                showBudgetEdit && React.createElement('div', { 
                    className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",
                    onClick: (e) => e.target === e.currentTarget && cancelBudgetEdit()
                },
                    React.createElement('div', { className: "bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto" },
                        React.createElement('div', { className: "sticky top-0 bg-white border-b p-6" },
                            React.createElement('div', { className: "flex justify-between items-center" },
                                React.createElement('h2', { className: "text-2xl font-bold text-gray-900" }, "Edit Budgets"),
                                React.createElement('button', {
                                    onClick: cancelBudgetEdit,
                                    className: "text-gray-400 hover:text-gray-600"
                                }, React.createElement(X, { className: "h-6 w-6" }))
                            ),
                            React.createElement('div', { className: "mt-4 flex space-x-2" },
                                ['Dan', 'Tien'].map(person =>
                                    React.createElement('button', {
                                        key: person,
                                        onClick: () => setBudgetEditPerson(person),
                                        className: `px-4 py-2 rounded-md transition-colors ${
                                            budgetEditPerson === person
                                                ? 'bg-indigo-600 text-white'
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`
                                    }, `${person}'s Budget`)
                                )
                            )
                        ),
                        React.createElement('div', { className: "p-6" },
                            React.createElement('div', { className: "space-y-4" },
                                categories.map(category =>
                                    React.createElement('div', { key: category, className: "flex items-center justify-between p-4 bg-gray-50 rounded-lg" },
                                        React.createElement('div', null,
                                            React.createElement('label', { className: "text-lg font-medium text-gray-900" }, category),
                                            React.createElement('p', { className: "text-sm text-gray-500" }, 
                                                `Current: €${budgets[budgetEditPerson][category]} (≈ $${(budgets[budgetEditPerson][category] * exchangeRate).toFixed(2)})`
                                            )
                                        ),
                                        React.createElement('div', { className: "flex items-center space-x-2" },
                                            React.createElement(Euro, { className: "h-5 w-5 text-gray-500" }),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "1",
                                                min: "0",
                                                value: tempBudgets[budgetEditPerson]?.[category] || budgets[budgetEditPerson][category],
                                                onChange: (e) => updateTempBudget(budgetEditPerson, category, e.target.value),
                                                className: "w-24 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-right"
                                            })
                                        )
                                    )
                                )
                            ),
                            React.createElement('div', { className: "mt-6 p-4 bg-indigo-50 rounded-lg" },
                                React.createElement('div', { className: "flex justify-between items-center" },
                                    React.createElement('span', { className: "text-lg font-semibold text-indigo-900" }, `Total Budget for ${budgetEditPerson}:`),
                                    React.createElement('div', { className: "text-right" },
                                        React.createElement('div', { className: "text-lg font-bold text-indigo-900" }, 
                                            `€${Object.values(tempBudgets[budgetEditPerson] || budgets[budgetEditPerson]).reduce((a, b) => a + b, 0)}`
                                        ),
                                        React.createElement('div', { className: "text-sm text-indigo-700" }, 
                                            `≈ $${(Object.values(tempBudgets[budgetEditPerson] || budgets[budgetEditPerson]).reduce((a, b) => a + b, 0) * exchangeRate).toFixed(2)} USD`
                                        )
                                    )
                                )
                            )
                        ),
                        React.createElement('div', { className: "sticky bottom-0 bg-white border-t p-6" },
                            React.createElement('div', { className: "flex space-x-3 justify-end" },
                                React.createElement('button', {
                                    onClick: cancelBudgetEdit,
                                    className: "px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors"
                                }, "Cancel"),
                                React.createElement('button', {
                                    onClick: saveBudgetChanges,
                                    className: "px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md flex items-center space-x-2 transition-colors"
                                },
                                    React.createElement(Save, { className: "h-4 w-4" }),
                                    React.createElement('span', null, "Save Changes")
                                )
                            )
                        )
                    )
                ),

                // Add/Edit Expense Form
                showAddForm && React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                    React.createElement('h2', { className: "text-xl font-semibold mb-4" }, editingId ? 'Edit Expense' : 'Add New Expense'),
                    React.createElement('div', { className: "space-y-4" },
                        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Description"),
                                React.createElement('input', {
                                    type: "text",
                                    value: formData.memo,
                                    onChange: (e) => setFormData({...formData, memo: e.target.value}),
                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",
                                    placeholder: "e.g., Dinner at local restaurant",
                                    required: true
                                })
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Category"),
                                React.createElement('select', {
                                    value: formData.category,
                                    onChange: (e) => setFormData({...formData, category: e.target.value}),
                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                },
                                    categories.map(cat =>
                                        React.createElement('option', { key: cat, value: cat }, cat)
                                    )
                                )
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Who's paying?"),
                                React.createElement('select', {
                                    value: formData.payer,
                                    onChange: (e) => setFormData({...formData, payer: e.target.value}),
                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                },
                                    React.createElement('option', { value: "Dan" }, "Dan"),
                                    React.createElement('option', { value: "Tien" }, "Tien"),
                                    React.createElement('option', { value: "Split" }, "Split (50/50)")
                                )
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Amount (EUR)"),
                                React.createElement('input', {
                                    type: "number",
                                    step: "0.01",
                                    value: formData.amount,
                                    onChange: (e) => setFormData({...formData, amount: e.target.value}),
                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",
                                    placeholder: "0.00",
                                    required: true
                                }),
                                formData.amount && React.createElement('div', { className: "text-sm text-gray-500 mt-1" },
                                    React.createElement('p', null, `≈ $${(parseFloat(formData.amount || 0) * exchangeRate).toFixed(2)} USD`),
                                    formData.payer === 'Split' && React.createElement('p', null, `€${(parseFloat(formData.amount || 0) / 2).toFixed(2)} each`)
                                )
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Date & Time"),
                                React.createElement('input', {
                                    type: "datetime-local",
                                    value: formData.date,
                                    onChange: (e) => setFormData({...formData, date: e.target.value}),
                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                })
                            )
                        ),
                        React.createElement('div', { className: "flex space-x-3" },
                            React.createElement('button', {
                                type: "button",
                                onClick: handleSubmit,
                                className: "bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md transition-colors"
                            }, editingId ? 'Update Expense' : 'Add Expense'),
                            React.createElement('button', {
                                type: "button",
                                onClick: resetForm,
                                className: "bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-md transition-colors"
                            }, "Cancel")
                        )
                    )
                ),

                // Categories Dashboard
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6" },
                    categories.map(category => {
                        let spent, budget;
                        
                        if (activePerson === 'Combined') {
                            spent = getCategorySpending(category, 'Dan') + getCategorySpending(category, 'Tien');
                            budget = budgets.Dan[category] + budgets.Tien[category];
                        } else {
                            spent = getCategorySpending(category, activePerson);
                            budget = budgets[activePerson][category];
                        }
                        
                        const percentage = (spent / budget) * 100;
                        
                        return React.createElement('div', { key: category, className: "bg-white rounded-lg shadow-lg p-6" },
                            React.createElement('div', { className: "flex justify-between items-center mb-3" },
                                React.createElement('h3', { className: "text-lg font-semibold text-gray-900" }, category),
                                React.createElement('div', { className: "text-right" },
                                    React.createElement('p', { className: "text-sm text-gray-500" }, `€${spent.toFixed(2)} / €${budget}`),
                                    React.createElement('p', { className: "text-xs text-gray-400" }, `$${(spent * exchangeRate).toFixed(2)} USD`)
                                )
                            ),
                            React.createElement('div', { className: "w-full bg-gray-200 rounded-full h-2" },
                                React.createElement('div', {
                                    className: `h-2 rounded-full transition-all duration-300 ${getProgressColor(spent, budget)}`,
                                    style: { width: `${Math.min(percentage, 100)}%` }
                                })
                            ),
                            React.createElement('p', { className: "text-xs text-gray-500 mt-2" }, `${percentage.toFixed(1)}% used`)
                        );
                    })
                ),

                // Recent Expenses
                expenses.length > 0 && React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-6" },
                    React.createElement('h2', { className: "text-xl font-semibold mb-4" }, "Recent Expenses"),
                    React.createElement('div', { className: "space-y-3" },
                        expenses.slice(-5).reverse().map(expense =>
                            React.createElement('div', { key: expense.id, className: "flex justify-between items-center p-3 bg-gray-50 rounded-lg" },
                                React.createElement('div', null,
                                    React.createElement('p', { className: "font-medium" }, expense.memo),
                                    React.createElement('p', { className: "text-sm text-gray-500" }, `${expense.category} • ${expense.payer} • ${new Date(expense.date).toLocaleDateString()}`)
                                ),
                                React.createElement('div', { className: "text-right" },
                                    React.createElement('p', { className: "font-semibold" }, `€${expense.amount.toFixed(2)}`),
                                    React.createElement('div', { className: "flex space-x-2" },
                                        React.createElement('button', {
                                            onClick: () => editExpense(expense),
                                            className: "text-blue-600 hover:text-blue-800"
                                        }, React.createElement(Edit3, { className: "h-4 w-4" })),
                                        React.createElement('button', {
                                            onClick: () => deleteExpense(expense.id),
                                            className: "text-red-600 hover:text-red-800"
                                        }, React.createElement(Trash2, { className: "h-4 w-4" }))
                                    )
                                )
                            )
                        )
                    )
                )
            )
        );
    };

    // Render the app
    ReactDOM.render(React.createElement(TravelBudgetTracker), document.getElementById('root'));
</script>

</body>
</html>
