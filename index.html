<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Budget Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <div id="root"></div>

<script>
    const { useState, useEffect, useRef } = React;
    
    // ... (your icon components remain unchanged) ...

    // [ ... all your icon components as before ... ]
    // (I left them out here for brevity, but you keep them unchanged)

    // All icon components here...

    const TravelBudgetTracker = () => {
        // (all your existing state, helpers, etc)

        // ... your state, hooks, functions, etc. unchanged ...

        // [ ... your state and function declarations as before ... ]

        // --- CSV Export Handler ---
        const exportToCSV = () => {
            try {
                const csvHeader = 'Date,Description,Category,Amount (EUR),Amount (USD),Payer,Dan Amount (EUR),Tien Amount (EUR)\n';
                const csvRows = expenses.map(expense => {
                    const date = new Date(expense.date).toLocaleString();
                    return `"${date}","${expense.memo.replace(/"/g, '""')}","${expense.category}",${expense.amount},${expense.usdAmount.toFixed(2)},"${expense.payer}",${expense.danAmount.toFixed(2)},${expense.tienAmount.toFixed(2)}`;
                }).join('\n');
                
                const csvContent = csvHeader + csvRows;
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', `travel-budget-${new Date().toISOString().split('T')[0]}.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            } catch (error) {
                console.error('Error exporting CSV:', error);
                alert('Error exporting data. Please try again.');
            }
        };

        // ... rest of your helpers ...

        // ... unchanged code ...

        return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4" },
            React.createElement('div', { className: "max-w-4xl mx-auto" },
                // Header (unchanged)
                React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-6 mb-6" },
                    // ... header contents unchanged ...
                    React.createElement('div', { className: "flex items-center justify-between" },
                        React.createElement('div', { className: "flex items-center space-x-3" },
                            React.createElement(MapPin, { className: "h-8 w-8 text-indigo-600" }),
                            React.createElement('div', null,
                                React.createElement('h1', { className: "text-3xl font-bold text-gray-900" }, "Travel Budget Tracker"),
                                React.createElement('p', { className: "text-gray-600" }, "Portugal & France Adventure - Dan & Tien")
                            )
                        ),
                        React.createElement('div', { className: "text-right" },
                            React.createElement('div', { className: "text-sm text-gray-500" }, "Exchange Rate"),
                            React.createElement('div', { className: "text-lg font-semibold" }, `1 EUR = $${exchangeRate.toFixed(2)} USD`)
                        )
                    ),
                    
                    // Person Toggle
                    React.createElement('div', { className: "mt-4 flex justify-center" },
                        React.createElement('div', { className: "bg-gray-100 rounded-lg p-1 flex" },
                            ['Dan', 'Tien', 'Combined'].map(person =>
                                React.createElement('button', {
                                    key: person,
                                    onClick: () => setActivePerson(person),
                                    className: `px-4 py-2 rounded-md transition-colors ${
                                        activePerson === person
                                            ? 'bg-indigo-600 text-white'
                                            : 'text-gray-600 hover:text-gray-900'
                                    }`
                                }, person)
                            )
                        )
                    )
                ),

                // --- ACTION BUTTONS ROW ---
                React.createElement('div', { className: "mb-6 flex flex-wrap gap-3" },
                    React.createElement('button', {
                        onClick: () => setShowAddForm(true),
                        className: "bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg flex items-center space-x-2 transition-colors"
                    },
                        React.createElement(PlusCircle, { className: "h-5 w-5" }),
                        React.createElement('span', null, "Add Expense")
                    ),
                    React.createElement('button', {
                        onClick: openBudgetEdit,
                        className: "bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg flex items-center space-x-2 transition-colors"
                    },
                        React.createElement(Settings, { className: "h-5 w-5" }),
                        React.createElement('span', null, "Edit Budgets")
                    ),
                    // --- EXPORT CSV BUTTON ---
                    React.createElement('button', {
                        onClick: exportToCSV,
                        className: "bg-blue-500 hover:bg-blue-700 text-white px-6 py-3 rounded-lg flex items-center space-x-2 transition-colors"
                    },
                        React.createElement('svg', { className: "h-5 w-5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", xmlns: "http://www.w3.org/2000/svg" },
                            React.createElement('path', { d: "M12 5v14m7-7H5" })
                        ),
                        React.createElement('span', null, "Export CSV")
                    )
                ),

                // ...rest of your app unchanged...
                // Budget Edit Modal
                showBudgetEdit && /* ... unchanged ... */,

                // Add/Edit Expense Form
                showAddForm && /* ... unchanged ... */,

                // Categories Dashboard
                /* ... unchanged ... */,

                // Recent Expenses
                expenses.length > 0 && /* ... unchanged ... */
            )
        );
    };

    // Render the app
    ReactDOM.render(React.createElement(TravelBudgetTracker), document.getElementById('root'));
</script>

</body>
</html>
